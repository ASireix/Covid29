<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>
    <script src="cluster/leaflet.markercluster-src.js"></script>
    <link rel="stylesheet" href="angular-md/angular-material.css">
    <link rel="stylesheet" href="cluster/MarkerCluster.css" />
    <link rel="stylesheet" href="cluster/MarkerCluster.Default.css" />
    <link type="text/css" rel="stylesheet" href="Page2.css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.js"></script>
    <script src="leafletui/ui-leaflet.min.js"></script>
    <script src="angular/angular-simple-logger.js"></script>
    <script src="angular-md/angular-material.js"></script>
    <script src="angular-an/angular-animate.js"></script>
    <script src="angular-ar/angular-aria.js"></script>




    <style>
        #leaflet-map {
            height: 800px;
            width: 1000px;
        }
    </style>
    <title>Grosse carte</title>

</head>

<body ng-app="angularApp">

    <h1>Bienvenue à toi jeune entrepreneur</h1>
    <div id="Page">
        <div id="carteCovid" ng-controller="Ctrl">
            <div layout="row">
                <div flex="">
                    <div layout="column">
                        <div flex="">
                            <leaflet id="leaflet-map" markers="markers" center="center"></leaflet>
                        </div>
                        <div flex="">
                            <md-content>

                                <section layout="row" layout-sm="column" layout-align="center center" layout-wrap>
                                    <md-button>Statistiques</md-button>
                                    <md-button md-no-ink class="md-primary">Primary (md-noink)</md-button>
                                    <md-button ng-disabled="true" class="md-primary">Disabled</md-button>
                                </section>
                            </md-content>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
        <form id="formulaire" class="css-form" ng-controller="Formulaire">
            <div id="Cadres">
                <div id="Infos">
                    <div name="I1">
                        <label for="pseudo">Prénom :</label>
                        <input name="pseudo" type="text" placeholder="ou Pseudo" ng-model="user.prenom">
                    </div>
                    <div name="I2">
                        <label for="age">Âge :</label>
                        <input name="age" type="number" placeholder="20" ng-model="user.age" required>
                    </div>
                    <div name="I3">
                        <label for="sexe">Sexe :</label>
                        <select id="sexe" ng-model="user.sexe">
                            <option value="autre">Autre</option>
                            <option value="homme">Homme</option>
                            <option value="femme">Femme</option>
                        </select>
                    </div>
                    <div name="I4">
                        <div id="DateLabel">
                            <label for="dateT">Jour du Test :</label>
                            <label for="dateR">Jour Résultat :</label>
                        </div>
                        <div id="DateInput">
                            <input name="dateT" type="date" ng-model="user.dateT" required>
                            <input name="dateR" type="date" ng-model="user.dateT">
                        </div>
                    </div>
                </div>
                <div>
                    <label>Test effectué pour la Covid-19:</label>
                </div>
                <div id="ResulTest">
                    <div>
                        <label>RP-PCR</label>
                        <input name="type" type="radio" ng-model="user.resulTest" value=1 required>
                    </div>
                    <div>
                        <label>Antigénique</label>
                        <input name="type" type="radio" ng-model="user.resulTest" value=2>
                    </div>
                    <div>
                        <label>Dépistage Salivaire</label>
                        <input name="type" type="radio" ng-model="user.resulTest" value=3>
                    </div>
                    <div>
                        <label>Sérologiques</label>
                        <input name="type" type="radio" ng-model="user.resulTest" value=4>
                    </div>
                </div>
            </div>
            <div id="Cadres">
                <div name="attente">
                    <label>Temps d'attentes :</label>
                    <div class="rating">
                    
                        <input id="a1" type="radio" name="attenteR" ng-model="user.attente" value="1" required> 
                        <label for="a1">1 star</label>
                        <input id="a2" type="radio" name="attenteR" ng-model="user.attente" value="2">
                        <label for="a2">2 stars</label>
                        <input id="a3" type="radio" name="attenteR" ng-model="user.attente" value="3">
                        <label for="a3">3 stars</label>
                        <input id="a4" type="radio" name="attenteR" ng-model="user.attente" value="4">
                        <label for="a4">4 stars</label>
                        <input id="a5" type="radio" name="attenteR" ng-model="user.attente" value="5">
                        <label for="a5">5 stars</label>
                        
                        <div class="stars">
                            <label for="a1" aria-label="1 star" title="1 star"></label>
                            <label for="a2" aria-label="2 stars" title="2 stars"></label>
                            <label for="a3" aria-label="3 stars" title="3 stars"></label>
                            <label for="a4" aria-label="4 stars" title="4 stars"></label>
                            <label for="a5" aria-label="5 stars" title="5 stars"></label>   
                        </div>
                    </div>        
                </div>
                <div name="prisecharge">
                    <label>Prise en charge :</label>
                    <div class="rating">
                    
                        <input id="pc1" type="radio" name="prisechargeR" ng-model="user.prisecharge" value="1" required> 
                        <label for="pc1">1 star</label>
                        <input id="pc2" type="radio" name="prisechargeR" ng-model="user.prisecharge" value="2">
                        <label for="pc2">2 stars</label>
                        <input id="pc3" type="radio" name="prisechargeR" ng-model="user.prisecharge" value="3">
                        <label for="pc3">3 stars</label>
                        <input id="pc4" type="radio" name="prisechargeR" ng-model="user.prisecharge" value="4">
                        <label for="pc4">4 stars</label>
                        <input id="pc5" type="radio" name="prisechargeR" ng-model="user.prisecharge" value="5">
                        <label for="pc5">5 stars</label>
                        
                        <div class="stars">
                            <label for="pc1" aria-label="1 star" title="1 star"></label>
                            <label for="pc2" aria-label="2 stars" title="2 stars"></label>
                            <label for="pc3" aria-label="3 stars" title="3 stars"></label>
                            <label for="pc4" aria-label="4 stars" title="4 stars"></label>
                            <label for="pc5" aria-label="5 stars" title="5 stars"></label>   
                        </div>
                        
                    </div>
                </div>
            </div>
            <div id="Cadres">
                <label for="commentaire">Commentaire :</label>
                <textarea name="commentaire" placeholder="Un avis, une remarque..." ng-model="user.commentaire"></textarea>
            </div>
            <div id="submit">
                <input type="submit" ng-click="update(user)">
            </div>
        </form>
    </div>
    <script type="text/javascript">
        var app = angular.module("angularApp", ['ngMaterial', 'ui-leaflet']);

        app.factory('dataInfo', function ($http) {
            return $http.get('ressources/dataCenter.json');
        });

        function addayerWithClustering(data) {

            var geoJsonLayer = L.geoJson(data, {
                onEachFeature: function (feature, layer) {
                    layer.bindPopup(feature.properties.name);
                }
            });

            markers.addLayer(geoJsonLayer);
            leafletData.getMap().then(function (map) {
                map.addLayer(markers);
                //map.fitBounds(markers.getBounds());
            });
        }

        app.controller("Ctrl", ["$scope", "dataInfo", "leafletData", function ($scope, dataInfo, leafletData) {

            angular.extend($scope, {
                center: {
                    lat: 46.095,
                    lng: 2.823,
                    zoom: 6
                },
                markers: {}

            });

            dataInfo.then(function (response) {

                var marqueurs = L.markerClusterGroup();

                $scope.dataCenter = response.data;
                //console.log($scope.markers);
                for (var i = 0; i < response.data.length; i++) {

                    //console.log(response.data[i].latitude);
                    //console.log(response.data[i].longitude);

                    var icontrobien = L.icon({
                        iconUrl: 'ressources/icon2.png',

                    });

                    var marker = new L.marker([response.data[i].latitude, response.data[i].longitude], { icon: icontrobien });
                    marqueurs.addLayer(marker);


                    leafletData.getMap("leaflet-map").then(function (map) {
                        map.addLayer(marqueurs);
                        //map.fitBounds(markers.getBounds());
                    });

                }

            })

            

        }]);

    </script>
    

</body>

</html>